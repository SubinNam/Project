<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>SB</title>
</head>
<body>
<h2 id='data-preprocessing'>Data Preprocessing </h2>
<p>&nbsp;</p>
<pre><code class='language-r' lang='r'>
library(caret)
setwd(&quot;~/Projects/R/Coursera-Practical-Machine-Learning-Assignment-1/&quot;)
trainURL &lt;- &quot;http://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv&quot;
testURL &lt;- &quot;http://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv&quot;

training &lt;- read.csv(url(trainURL))
testing &lt;- read.csv(url(testURL))

label &lt;- createDataPartition(training$classe, p = 0.7, list = FALSE)
train &lt;- training[label, ]
test &lt;- training[-label, ]

</code></pre>
<pre><code class='language-r' lang='r'>
NZV &lt;- nearZeroVar(train)
train &lt;- train[ ,-NZV]
test &lt;- test[ ,-NZV]

label &lt;- apply(train, 2, function(x) mean(is.na(x))) &gt; 0.95
train &lt;- train[, -which(label, label == FALSE)]
test &lt;- test[, -which(label, label == FALSE)]

train &lt;- train[ , -(1:5)]
test &lt;- test[ , -(1:5)]

</code></pre>
<h2 id='prediction-model-selection'>Prediction Model Selection</h2>
<pre><code class='language-r' lang='r'>
Random Forest

</code></pre>
<pre><code class='language-r' lang='r'>library(caret)
set.seed(13908)
control &lt;- trainControl(method = &quot;cv&quot;, number = 3, verboseIter=FALSE)
modelRF &lt;- train(classe ~ ., data = train, method = &quot;rf&quot;, trControl = control)
modelRF$finalModel

predictRF &lt;- predict(modelRF, test)
confMatRF &lt;- confusionMatrix(predictRF, test$classe)
confMatRF

</code></pre>
<pre><code class='language-r' lang='r'>Predicting Test Set Output
</code></pre>
<pre><code class='language-r' lang='r'>
predictRF &lt;- predict(modelRF, testing)
predictRF

</code></pre>
</body>
</html>